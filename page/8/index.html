<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":250,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="知行合一">
<meta property="og:url" content="http://yoursite.com/page/8/index.html">
<meta property="og:site_name" content="知行合一">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="知行合一">

<link rel="canonical" href="http://yoursite.com/page/8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>知行合一</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">知行合一</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/22/基础知识/Go/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/22/基础知识/Go/" class="post-title-link" itemprop="url">go</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-06-22 15:42:16" itemprop="dateCreated datePublished" datetime="2019-06-22T15:42:16+08:00">2019-06-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-07-02 15:42:16" itemprop="dateModified" datetime="2019-07-02T15:42:16+08:00">2019-07-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="go语言学习">Go语言学习</h2>
<h3 id="注意点">注意点</h3>
<h4 id="变量类型">变量类型</h4>
<ol>
<li>切片和指针都是引用类型</li>
<li>实际存储的字符的ascii值,没有char,取而代之的是byte(uint8),rune(int32)</li>
<li>raw string？？</li>
<li>fmt.Println 与 println的区别</li>
<li>list.List 与 list.New() 的[区别]](<a href="https://golang.org/pkg/container/list/" target="_blank" rel="noopener">https://golang.org/pkg/container/list/</a>)<a href="https://blog.csdn.net/xxx9001/article/details/52574501" target="_blank" rel="noopener">CSDN</a><br>
list.List 返回的是一个结构体值类型,list.New()返回的是一个初始化的结构体的指针类型,区别在于1.作为函数参数传入时,list.List不可更改,而指针类型可更改2.传入参数需要与函数定义相同,即函数定义的是值类型,那么只能传入值类型</li>
</ol>
<h4 id="方法-与-函数-的-区别">方法 与 函数 的 区别</h4>
<p>方法区别于函数的点在于,方法有一个接受者(值接受者 或者 指针接受者).<br>
值接受者会拷贝副本.</p>
<h4 id="函数名或者变量首字母大写">函数名或者变量首字母大写</h4>
<p>变量或函数的首字母大写时,才可以从包中导出/包外部可见</p>
<h4 id="接口转型">接口转型</h4>
<p>两种方式</p>
<ul>
<li>instance, ok := 接口对象.(实际类型).可以配合if…else if使用</li>
<li>接口对象.(type).实际类型被赋值到type,配合switch…case使用.</li>
</ul>
<h4 id="fmtstringer">fmt.Stringer</h4>
<p>Stringer 接口包含 String() 方法，定义如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type Stringer interface &#123;</span><br><span class="line">    String() string</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>任何类型只要实现了 String() 方法,在进行Print 输出时，可以使用 其实现 String() 中的定义。</p>
<h4 id="sync"><a href="https://docs.studygolang.com/pkg/sync/" target="_blank" rel="noopener">sync</a></h4>
<p>sync 包提供基础的同步功能，例如互斥锁。除了Once、WaitGroup类型，大多数应用于底层链接库。一般借助 channel 和 通信 实现 高层次同步。<br>
不建议复制 sync 中类型的值。<br>
常用的类型包括：</p>
<ul>
<li>Locker</li>
<li>Map</li>
<li>Mutex</li>
<li>Once</li>
<li>WaitGroup</li>
<li>Cond</li>
<li>Pool</li>
<li>RWMutex</li>
</ul>
<p>Once 是一个只会执行一个动作的对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">type Once struct &#123;</span><br><span class="line">    // contains filtered or unexported fields</span><br><span class="line">&#125; </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">Example</span><br></pre></td></tr></table></figure>
<p>func main() {<br>
var once sync.Once<br>
onceBody := func() {<br>
fmt.Println(“Only once”)<br>
}<br>
done := make(chan bool)<br>
for i := 0; i &lt; 10; i++ {<br>
go func() {<br>
<a href="http://once.Do" target="_blank" rel="noopener">once.Do</a>(onceBody)<br>
done &lt;- true<br>
}()<br>
}</p>
<pre><code>for i := 0; i &lt; 10; i++ {
	&lt;-done
}
</code></pre>
<p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">一个 WaitGroup 是一个待完成的 go 协程集合。主协程通过 Add 方法 设置等待的协程的数量。每个协程结束之后调用 Done 方法。同时，Wait 方法可以用于阻塞当前协程直至所有协程都完成。</span><br></pre></td></tr></table></figure>
<p>type httpPkg struct{}</p>
<p>func (httpPkg) Get(url string) {}</p>
<p>var http httpPkg</p>
<p>func main() {<br>
var wg sync.WaitGroup<br>
var urls = []string{<br>
“<a href="http://www.google.org/" target="_blank" rel="noopener">http://www.google.org/</a>”,<br>
“<a href="http://www.google.com/" target="_blank" rel="noopener">http://www.google.com/</a>”,<br>
“<a href="http://www.somestupidname.com/" target="_blank" rel="noopener">http://www.somestupidname.com/</a>”,<br>
}<br>
for _, url := range urls {<br>
// Increment the WaitGroup counter.<br>
wg.Add(1)<br>
// Launch a goroutine to fetch the URL.<br>
go func(url string) {<br>
// Decrement the counter when the goroutine completes.<br>
defer wg.Done()<br>
// Fetch the URL.<br>
fmt.Println(url)<br>
http.Get(url)<br>
}(url)<br>
}<br>
// Wait for all HTTP fetches to complete.<br>
wg.Wait()<br>
}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#### [reflect](https://docs.studygolang.com/pkg/reflect/)</span><br><span class="line">refelct 包继承运行时反射接口，允许程序操作任何类型的对象。</span><br><span class="line">常用的方法是 利用一个有静态类型 interface&#123;&#125; 的值 并 通过调用TypeOf方法(返回Type)抽取出它的动态信息。</span><br><span class="line"></span><br><span class="line">ValueOf 方法返回 实时数据的值。Zero 方法返回一个当前类型的 零值的 Type类型。</span><br><span class="line"></span><br><span class="line">#### [runtime](https://docs.studygolang.com/pkg/runtime/)</span><br><span class="line">runtime包 包含与Go运行时系统交互的相关操作，例如函数控制协程。也包含reflect包使用的底层信息。</span><br><span class="line"></span><br><span class="line">## 分布式系统学习第一弹</span><br><span class="line">[MIT 6.824](https://pdos.csail.mit.edu/6.824/labs/lab-1.html)</span><br><span class="line">按照课程要求,下载源码</span><br><span class="line">修改一：添加日志,在 go  init 函数更改日志格式,使得输出时带位置</span><br></pre></td></tr></table></figure>
<p>//init log format<br>
func init(){<br>
log.SetFlags(log.Ldate| log.Lshortfile |log.Ltime |log.LUTC)<br>
}<br>
//样例输出<br>
2019/07/22 07:34:41 master_splitmerge.go:23: Merge: open mrtmp.test-res-0: no such file or directory</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## cache2go 学习</span><br><span class="line">[项目结构 简介](https://blog.csdn.net/notbaron/article/details/52008155)</span><br><span class="line">[Go缓存库cache2go介绍](https://blog.csdn.net/zhizhengguan/article/details/84257338)</span><br><span class="line"></span><br><span class="line">## go 语言</span><br><span class="line">实现长度为变量的二维数组</span><br></pre></td></tr></table></figure>
<p>var status [][]int<br>
for i := 0; i &lt; len(variable1); i++ {<br>
var statu = make([]int, len(variable2))<br>
status = append(status, statu)<br>
}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">range</span><br></pre></td></tr></table></figure>
<p>for <em>, num := range nums {<br>
sum += num<br>
}<br>
fmt.Println(“sum:”, sum)<br>
<a href="//xn--rangeindex-ui2p8juc93qtubz0fd4gy8mvkdkvs21ywk1cotxe1g4b0r3f.xn--fhqg0gu0bbvdcx4ogsht7stuhdmkwx3dkyd162abo6b38hn3u7f0a8tb">//在数组上使用range将传入index和值两个变量.上面那个例子我们不需要使用该元素的序号</a>,所以我们使用空白符&quot;</em>&quot;省略了.有时侯我们确实需要知道它的索引.<br>
for i, num := range nums {<br>
if num == 3 {<br>
fmt.Println(“index:”, i)<br>
}<br>
}</p>
<pre><code>
make vs new

</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/19/基础知识/系统配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/19/基础知识/系统配置/" class="post-title-link" itemprop="url">系统配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-06-19 19:17:38" itemprop="dateCreated datePublished" datetime="2019-06-19T19:17:38+08:00">2019-06-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-30 13:18:55" itemprop="dateModified" datetime="2020-08-30T13:18:55+08:00">2020-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>安装mysql，按照官网教程来即可 <a href="https://dev.mysql.com/doc/refman/8.0/en/linux-installation-yum-repo.html" target="_blank" rel="noopener">官网连接</a><br>
在 windows 下安装MySQL时会出现错误</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D:\Software\Mysql-8.0.17-winx64\bin&gt;net start MySQL</span><br><span class="line">服务没有响应控制功能。</span><br><span class="line">请键入 NET HELPMSG 2186 以获得更多的帮助。</span><br></pre></td></tr></table></figure>
<p>解决方法：在windows 服务控制中，设置MySQL服务的属性-&gt;登陆-&gt;登陆身份  中设置身份为此身份，身份应当有Administration权限<br>
安装java</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/17/基础知识/bwg/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/17/基础知识/bwg/" class="post-title-link" itemprop="url">bwg</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-06-17 16:31:44" itemprop="dateCreated datePublished" datetime="2019-06-17T16:31:44+08:00">2019-06-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-30 13:25:00" itemprop="dateModified" datetime="2020-08-30T13:25:00+08:00">2020-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天尝试给bwg上的vpn安装上支持 IPV4,IPV6和多端口（即监听来自IPV4,ipv6的多个端口的访问）<br>
弄了半天，把多端口访问的问题，弄好了，但是同时允许IPV4，IPv6的不行，被恶心了（有空再折腾这个）<br>
暂且记录下流程</p>
<ul>
<li>寻找多端口的方法；由于我的配置是基于openvpn，只能设置一个端口；多端口的话，可以安装基于python实现的shadowsocks</li>
<li>进行最后一步发现，都是对ssserver的配置</li>
<li>尝试配置监听IPV4,IPV6访问，尝试过各种配置发现，最后找到以为博主的方法，从方法逻辑上看，是可以的，但是实际中不行，可能是我的其他配置问题（例如防火墙？），但下次再折腾这个，再次列出 <a href="http://jinke.me/2015-12-20-shadowsocks/" target="_blank" rel="noopener">链接</a>,因为比较敏感，以防丢失，暂且记录下思路；大概是分别存在IPv4与ipv6的配置文件，并启动shadowsocks 分配给不同的进程</li>
<li>由于基于python的shadowsocks很久都没有更新了，看github上的讨论，基于c语言的shadowsocks可以实现ipv4v6共存，因而尝试安装基于c语言的shadowsocks；</li>
<li>发现安装shadowsocks-libev 需要很多依赖，而且依赖循环依赖，很恶心，尝试了一阵后，因为马上有事，就暂且放弃</li>
<li>步骤1:在https://pkgs.org/上寻找需要的centosrpm包，下载，安装 ；步骤2：重复步骤1</li>
<li>注意点：下载rpm包时，注意与自己服务器的系统对应（比如 我的系统是centos6，下载的7，/(ㄒoㄒ)/~~）； 留心该命令  yum install --downloadonly --downloaddir=/root/rpm <package-name> 以及<a href="https://blog.csdn.net/xuxile/article/details/88699910" target="_blank" rel="noopener">链接</a>，似乎可以避免循环依赖的问题,但是尝试失败；在使用yum repolist all 查看时发现很多源都被禁止，不知道为什么？下次有空探究下；</package-name></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/27/基础知识/跨域问题小结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/27/基础知识/跨域问题小结/" class="post-title-link" itemprop="url">跨域问题小结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-27 11:56:40" itemprop="dateCreated datePublished" datetime="2019-05-27T11:56:40+08:00">2019-05-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-30 13:25:24" itemprop="dateModified" datetime="2020-08-30T13:25:24+08:00">2020-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近在做项目时经常遇到跨域问题，经历过这种折腾，最终有两种比较可行的方法，但总体而言都是代理转发</p>
<ul>
<li>在nginx上部署相关请求的代理转发，在将请求指向同域名的nginx服务器</li>
<li>将请求转发给网关，由网关做代理</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/22/基础知识/微服务授权/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/22/基础知识/微服务授权/" class="post-title-link" itemprop="url">微服务授权</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-22 21:08:04" itemprop="dateCreated datePublished" datetime="2019-05-22T21:08:04+08:00">2019-05-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-30 13:18:55" itemprop="dateModified" datetime="2020-08-30T13:18:55+08:00">2020-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>目前准备使用外部授权认证服务与kong结合，kong可能制作简单的限流任务；<br>
经过查询，发现kong在这里提供两个插件<br>
<a href="https://docs.konghq.com/hub/kong-inc/oauth2/" target="_blank" rel="noopener">OAuth 2.0 Authentication</a><br>
和 <a href="https://docs.konghq.com/hub/kong-inc/oauth2-introspection/" target="_blank" rel="noopener">OAuth 2.0 Introspection</a><br>
前者主要可以提供Oauth 认证服务，而后者支持第三方的授权认证服务器，不过仅支持企业版<br>
最后找到一个github同仁自己基于 lua开发的相关插件，<a href="https://github.com/mogui/kong-external-oauth" target="_blank" rel="noopener">链接</a></p>
<p>安装 这个额外插件，重新启动kong 时，luarock 需要luacrypto 去完成加密相关操作，故直接即可  sudo luarocks install luacrypto（从源码配置有点麻烦）</p>
<p>Spring Security 源码分析系列博客<br>
<a href="https://niocoder.com/categories/#Security" target="_blank" rel="noopener">链接1</a><br>
<a href="http://www.liuhaihua.cn/%E5%8F%B2%E4%B8%8A%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84-springcloud-%E6%95%99%E7%A8%8B" target="_blank" rel="noopener">链接2</a></p>
<p>spring 讲解<br>
<a href="https://www.cnblogs.com/RunForLove/p/4641672.html" target="_blank" rel="noopener">链接1</a></p>
<p>spring 默认配置<br>
<a href="https://www.jianshu.com/p/b02691ff4093" target="_blank" rel="noopener">链接1</a></p>
<p>springboot+springsecurity+oauth2整合(并用mysql数据库实现持久化客户端数据 <a href="https://blog.csdn.net/Victor_An/article/details/81510874" target="_blank" rel="noopener">链接1</a></p>
<p>spring登录认证 与 token<br>
<a href="https://www.huangyunkun.com/2016/03/02/spring-security-form-to-token/" target="_blank" rel="noopener">链接1</a><br>
<a href="https://www.jianshu.com/p/19059060036b" target="_blank" rel="noopener">链接2</a><br>
<a href="https://www.jianshu.com/p/68779236aa23" target="_blank" rel="noopener">链接3</a><br>
<a href="https://www.cnblogs.com/xifengxiaoma/p/10043173.html" target="_blank" rel="noopener">链接4 个人觉得最详细</a><br>
access_token 获取过程 <a href="https://www.cnblogs.com/lexiaofei/p/7152326.html?utm_source=itdadao&amp;utm_medium=referral" target="_blank" rel="noopener">链接1</a></p>
<p>access_token 更改返回 <a href="https://www.jianshu.com/p/d9a35facff6f" target="_blank" rel="noopener">链接1</a></p>
<p>oauth2数据库 表的说明 <a href="https://www.cnblogs.com/donglu/articles/10218348.html" target="_blank" rel="noopener">链接1</a><br>
<a href="https://www.bbsmax.com/A/qVdeeNmndP/" target="_blank" rel="noopener">链接2</a><br>
<a href="http://www.andaily.com/spring-oauth-server/db_table_description.html" target="_blank" rel="noopener">链接3</a></p>
<p>oauth2 授权过程说明 来自知乎<a href="https://www.zhihu.com/question/19781476" target="_blank" rel="noopener">链接1</a><br>
<a href="http://andaily.com/spring-oauth-server/db_table_description.html" target="_blank" rel="noopener">链接2</a></p>
<p>接口测试链接(备用)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST http://localhost:8082/oauth/token?grant_type=client_credentials&amp;client_id=curl_client&amp;client_secret=user</span><br><span class="line"></span><br><span class="line">GET http://localhost:8082/oauth/check_token?grant_type=client_credentials&amp;token=445d302d-4fa1-49c4-8800-617bd72dd1e9</span><br></pre></td></tr></table></figure>
<p>在直接使用JdbcClientDetailsService 直接查询数据时，出现变量为null<br>
即在非controller 层使用 @AUtowired时，无法取得变量<br>
使用 如下方法 解决  <a href="https://blog.csdn.net/u013294097/article/details/84192367" target="_blank" rel="noopener">链接</a></p>
<p>error</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data too long for oauth_code column &apos;authentication&apos;</span><br><span class="line">这是在oauth服务器中获取oauth_code时往数据库插入值时，发生的意外，在网上找到许多奇奇怪怪的方法，行不通，最后发现自己在数据库oauth建表是oauth_code 表 authentication 表项为 VARBINARY 而实际应该是 LONG VARBINARY</span><br></pre></td></tr></table></figure>
<p>2019-5-21</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">目前，打算借助oauth2 实现SSO ,利用client_credential 来识别不同系统或者应用，只不过比较困惑的是如何定义用户的权限(目前做demou先不考虑)</span><br></pre></td></tr></table></figure>
<p>2019-5-23<br>
认证流程<br>
1.系统A检测是否有token，没有跳转</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8082/oauth/authorize?client_id=test&amp;redirect_uri=http://127.0.0.1&amp;response_type=code&amp;scope=read</span><br></pre></td></tr></table></figure>
<p>2.填写用户名与密码（图片不对，待更换）<br>
<img src="https://github.com/walkdeadtobe/picture/raw/master/code_check_token.png" alt="登录_png"><br>
3.返回相应code 到系统A，系统A根据code到授权服务器申请token（部分图片错误，待更改）</p>
<blockquote>
<p>获取code<br>
<img src="https://github.com/walkdeadtobe/picture/raw/master/code_check_token.png" alt="获取code_png"></p>
</blockquote>
<blockquote>
<p>根据code获取token<br>
<img src="https://github.com/walkdeadtobe/picture/raw/master/code_token.png" alt="获取token_png"></p>
</blockquote>
<p>4.系统检测到token后，需要到授权系统检测该token对应的用户权限</p>
<blockquote>
<p>获取token所对应用户权限<br>
<img src="https://github.com/walkdeadtobe/picture/raw/master/code_check_token.png" alt="检测token_png"></p>
</blockquote>
<p>2019-7-24<br>
最近涉及到单点登陆系统记住用户所登陆的系统，下次访问默认登陆,经过思考可以在cookie里面添加tag字段,在接受登陆请求之后标志所登陆的系统,下次登陆时可以以此作为标志,此外应当保证登陆另外一个系统时，字段值更改(js),这就需要后端向前端传值,由于sprig boot里传递的是modelandview 所以不采用在url链接链接里附上参数的方法，转而 controller层通过Model对象传值到对应的返回页面，返回页面获得相应的参数来做处理;<br>
前端页面我 使用 thymeleaf模板引擎 渲染,其也有相应的方法取值<br>
后端：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(&quot;/login&quot;)</span><br><span class="line">    public ModelAndView loginPage(HttpServletRequest request, HttpServletResponse response) &#123;</span><br><span class="line">        RequestCache requestCache= new HttpSessionRequestCache();</span><br><span class="line">        SavedRequest savedrequest = requestCache.getRequest(request,response);</span><br><span class="line">        ModelAndView model = new ModelAndView(&quot;login&quot;);</span><br><span class="line">        model.addObject(&quot;from&quot;, &quot;all&quot;);</span><br><span class="line">       return model;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>前端：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">var s_from = [[$&#123;from&#125;]];</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;p  th:text=&quot;#&#123;from&#125;&quot;&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<p>此外，由于需要获得服务启动时服务本身的端口号，需要配置读取 Application.yml 的配置信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># @ConfigurationProperties 注解依赖</span><br><span class="line">&lt;dependency&gt;  </span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;  </span><br><span class="line">    &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;  </span><br><span class="line">    &lt;optional&gt;true&lt;/optional&gt;  </span><br><span class="line">&lt;/dependency&gt;  </span><br><span class="line"></span><br><span class="line">#Application.yml 部分内容</span><br><span class="line">server:</span><br><span class="line">  port: 80</span><br><span class="line">  address: 0.0.0.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 配置类</span><br><span class="line">package com.aak.configuration;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">@Component</span><br><span class="line">@ConfigurationProperties(prefix=&quot;server&quot;) //接收application.yml中的server下面的属性</span><br><span class="line">public class MyApplication &#123;</span><br><span class="line">    public String address;</span><br><span class="line">    public String port;</span><br><span class="line">    public String getUrl() &#123;</span><br><span class="line">        return address;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setUrl(String Url) &#123;</span><br><span class="line">        this.address = Url;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getPort() &#123;</span><br><span class="line">        return port;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setPort(String port) &#123;</span><br><span class="line">        this.port = port;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#使用</span><br><span class="line">@Autowired</span><br><span class="line">private MyApplication myApplication ;</span><br><span class="line">String port=myApplication.getPort();</span><br><span class="line">log.info(&quot;port:&quot;+port);</span><br></pre></td></tr></table></figure>
<p>2019-8-5<br>
spring security oauth2 authorization code模式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[Spring Security Oauth 相关配置默认实现](https://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/endpoint/package-summary.html),其中包含(后期重新排版)</span><br><span class="line">AuthorizationEndpoint:Implementation of the Authorization Endpoint from the OAuth2 specification.</span><br><span class="line">CheckTokenEndpoint:Controller which decodes access tokens for clients who are not able to do so (or where opaque token values are used).</span><br><span class="line">DefaultRedirectResolver:Default implementation for a redirect resolver.</span><br><span class="line">ExactMatchRedirectResolver:Strict implementation for a redirect resolver which requires an exact match between the registered and requested redirect_uri.</span><br><span class="line">FrameworkEndpointHandlerMapping:A handler mapping for framework endpoints (those annotated with @FrameworkEndpoint).</span><br><span class="line">TokenEndpoint:Endpoint for token requests as described in the OAuth2 spec.</span><br><span class="line">TokenEndpointAuthenticationFilter:An optional authentication filter for the TokenEndpoint.</span><br><span class="line">TokenKeyEndpoint:OAuth2 token services that produces JWT encoded token values.</span><br><span class="line">WhitelabelApprovalEndpoint:Controller for displaying the approval page for the authorization server.</span><br><span class="line">WhitelabelErrorEndpoint:Controller for displaying the error page for the authorization server.</span><br><span class="line"></span><br><span class="line">最近需要在单点登录系统中实现在登录完成之后.跳转回系统跳转登录的页面</span><br><span class="line">code 模式下, </span><br><span class="line">1.跳转 http://localhost:8080/oauth/authorize?client_id=test2&amp;redirect_uri=http://127.0.0.1/oauth/code&amp;response_type=code&amp;scope=read</span><br><span class="line">2.登录成功之后返回code即重定向至http://127.0.0.1/oauth/code?code=CODE</span><br><span class="line">3.http://127.0.0.1/oauth/code?code=CODE获取code,传至后端,后端由此可以根据code获取token以Set-Cookie的方式返回response到页面</span><br><span class="line"></span><br><span class="line">AuthorizationEndpoint 实现 /oauth/authorize 接口,[实现流程](https://www.cnblogs.com/xifengxiaoma/p/10043173.html)中首先检验相关信息正确,之后在code模式下会生成code,并跳转回 redirect_uri?code=CODE</span><br><span class="line">最初以为需要重写 [AuthorizationEndpoint 实现](http://www.javased.com/?source_dir=spring-security-oauth/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/AuthorizationEndpoint.java) 下面 /oauth/authorize 接口,使得最终重定向到redirect_uri后在链接中添加上跳转发生时来源的网址.经过调查没有找到重写 AuthorizationEndpoint 类的方法(spring security 没有提供接口,使得重写类覆盖默认类, 发生作用)</span><br><span class="line">后来发现 跳转时 是 由 window.location.href 实现的,但是无法像request请求一样 拥有 referer header ,即使能够重写 AuthorizationEndpoint 类,也不能从保存的请求中获取 相关header,只能在跳转链接中附上相关信息(暂时没有调研,是否可以在跳转的同时携带相关信息);</span><br><span class="line">问题在于 跳转回redirect_uri是在AuthorizationEndpoint 实现的,具体的地址已经配置好,而且没有找到相关的filter可以在这处理发生后拦截,进行相关逻辑处理,之后想到可以把 redirect_u redirect_uri 中,即redirect_uri=/oauth/code?back_to=原本处理code的地址</span><br><span class="line">以及可以在 跳转链接上 附上 window.location 信息(refer=window.location),然后在 login 中保存相关信息到 当前session,然后在接口中/oauth/code 接口实现中,提取出back_to和 code值,以及附上从session 获得的refer,返回,告知back_to获得token 后应当跳转的地址</span><br><span class="line">完整链接如下:</span><br><span class="line">window.location.href=&apos;http://localhost:8080/oauth/authorize?client_id=test2&amp;redirect_uri=/oauth/code?back_to=http://127.0.0.1/oauth/code&amp;response_type=code&amp;scope=read&amp;refer=&apos;+window.location</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/21/基础知识/watch_dog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/21/基础知识/watch_dog/" class="post-title-link" itemprop="url">watch_dog</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-21 16:12:45" itemprop="dateCreated datePublished" datetime="2019-05-21T16:12:45+08:00">2019-05-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-30 13:25:37" itemprop="dateModified" datetime="2020-08-30T13:25:37+08:00">2020-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>由于需要某些程序一直运行，或者能够自动重启，由此接触到看门狗程序这一概念</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/15/基础知识/运维/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/15/基础知识/运维/" class="post-title-link" itemprop="url">运维</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-15 17:03:39" itemprop="dateCreated datePublished" datetime="2019-05-15T17:03:39+08:00">2019-05-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-30 13:25:24" itemprop="dateModified" datetime="2020-08-30T13:25:24+08:00">2020-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>为了测试整个系统的稳定性，写了一个脚本，模仿整个登录过程，中间出错就报错<br>
了解到一个好工具 selenium<br>
<a href="https://blog.csdn.net/wkb342814892/article/details/81591394" target="_blank" rel="noopener">如何在centos上安装使用selenium-1</a><br>
<a href="https://www.bbsmax.com/A/A2dmRBKWze/" target="_blank" rel="noopener">如何在centos上安装使用selenium-2</a></p>
<p>为了更为精确的监控网页，考虑使用selenium模拟打开每个页面去检查其中网络请求是否正常获得，最终的目标是获取类似chrome开发者模式中Network中的效果，但是经调查发现，selenium中没有对这部分进行实现(或者与其最初目标无关，不考虑实现)，找到的可行的方案是使用 selenium + browsermob-proxy,<br>
<a href="https://browsermob-proxy-py.readthedocs.io/en/latest/" target="_blank" rel="noopener">browsermob-proxy 官方文档</a><br>
<a href="https://github.com/webmetrics/browsermob-proxy/downloads" target="_blank" rel="noopener">browsermob-proxy 下载</a></p>
<p><a href="https://stackoverflow.com/questions/48979520/chrome-headless-proxy-server" target="_blank" rel="noopener">示例代码</a></p>
<p>记录下中间遇到的问题：</p>
<blockquote>
<ol>
<li>端口冲突，报错</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;use_for_temporary.py&quot;, line 160, in &lt;module&gt;</span><br><span class="line">    selenium_example()</span><br><span class="line">  File &quot;use_for_temporary.py&quot;, line 81, in selenium_example</span><br><span class="line">    proxy=server.create_proxy()</span><br><span class="line">  File &quot;/root/anaconda3/lib/python3.7/site-packages/browsermobproxy/server.py&quot;, line 40, in create_proxy</span><br><span class="line">    client = Client(self.url[7:], params)</span><br><span class="line">  File &quot;/root/anaconda3/lib/python3.7/site-packages/browsermobproxy/client.py&quot;, line 38, in __init__</span><br><span class="line">    self.port = jcontent[&apos;port&apos;]</span><br><span class="line">KeyError: &apos;port&apos;</span><br></pre></td></tr></table></figure>
<p>经过查看源码，大约猜测是网络端口的问题(后来发现在产生的server.log 中把问题说的很清楚 ( ╯□╰ ))，查看相关文档确定 browsermob-proxy 启动的端口默认是8080 <a href="https://cloud.tencent.com/developer/news/365789" target="_blank" rel="noopener">相关文档</a> ,而服务器中已经使用的端口包括这个，考虑更改其启动的配置参数，按照上述文档的方法下修改，无效报错，经过查看与browsermob-proxy 版本对应 的官方文档<a href="https://browsermob-proxy-py.readthedocs.io/en/latest/server.html" target="_blank" rel="noopener">Server 初始化</a> 以及相应解析源码，重新修改配置<br>
为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server=Server(&quot;/root/download/browsermob-proxy-2.0-beta-6/bin/browsermob-proxy&quot;,&#123;&quot;host&quot;:&quot;localhost&quot;,&quot;port&quot;:9000&#125;)</span><br></pre></td></tr></table></figure>
<p>成功</p>
<blockquote>
<ol start="2">
<li>文件引用问题</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;use_for_temporary.py&quot;, line 159, in &lt;module&gt;</span><br><span class="line">    selenium_example()</span><br><span class="line">  File &quot;use_for_temporary.py&quot;, line 79, in selenium_example</span><br><span class="line">    server.start()</span><br><span class="line">  File &quot;/root/anaconda3/lib/python3.7/site-packages/browsermobproxy/server.py&quot;, line 122, in start</span><br><span class="line">    raise ProxyServerError(message)</span><br><span class="line">browsermobproxy.exceptions.ProxyServerError: The Browsermob-Proxy server process failed to start. Check &lt;_io.TextIOWrapper name=&apos;/root/py_auto/Gateway_auto/server.log&apos; mode=&apos;w&apos; encoding=&apos;UTF-8&apos;&gt;for a helpful error message.</span><br><span class="line"># server.log</span><br><span class="line">错误: 找不到或无法加载主类 org.browsermob.proxy.Main</span><br></pre></td></tr></table></figure>
<p>原因：我将browsermob-proxy解压后，将其中bin目录下browsermobproxy专门提取出来，放在一个专门目录下(以为是可执行文件)，引用之，后来发现它和windows下使用的browsermobproxy.bat 一样都是个脚本文件，需要在项目的固定位置<br>
解决：将引用目录指向目录文件下的browsermobproxy</p>
<blockquote>
<ol start="3">
<li>工具版本适配问题</li>
</ol>
</blockquote>
<p>问题：使用browsermob-proxy +selenium 时候，出现网络请求异常，在查看browsermob-proxy 产生的har记录文件时发现某些网路请求异常，返回-999(no response)或者0,不是正常的返回，但是单独用requests 模块去做请求时，又没有问题，于是考虑是因为webdriver结束过早，考虑过强制sleep,以及 driver.implict_wait(),但是都起不到作用，或者不够明显。<br>
后来思考了下，我想要做的事情是判断页面是否加载正常，静态数据大多没有太多问题，主要是动态数据，即我所关注或者担心的大部属分请求都是ajax异步请求，前面那些方法可能没有太多作用，于是查找是否有有相关手段使selenium 等待所有ajax请求结束，其中提到了selenium的三种等待方式：强制等待(sleep等方法)，隐式等待(driver.implict_wait(),全局效果)，显式等待(在一定时间内等待某一元素的出现)<br>
最终采取的是第三种方法，</p>
<blockquote>
<p>WebDriverWait(driver, 30).until(lambda s: s.execute_script(“return jQuery.active == 0”))</p>
</blockquote>
<p>参考<a href="https://www.cnblogs.com/aoyede/articles/5804184.html" target="_blank" rel="noopener">博客</a></p>
<p>但是在centos服务器上加上这行代码会出现<br>
jQuery/$(如果使用 $.active)  no defined<br>
最开始考虑类似与之前的方法，是因为这段脚本在jQuery加载之前执行引起的错误，后来尝试过强制等待后添加这行代码，无论等待多长时间都没有效果 ,开始怀疑是因为服务器环境的特殊性，于是在window笔记本,ubuntu台式机上尝试都没有异常，然后开始怀疑是环境配置的问题，其中包含的环境配置主要有selenium ,chromdriver,google-chrome,browsermob-proxy<br>
由于selenium都是用pip安装的最新的，不考虑<br>
然后发现centos服务器上的google-chrome是最新版76.0.3809.12   ,而windows上是75.0.3770.8，ubuntu上chromium是 v74.0.3729.6然后依据windowsde 配置调整了chromdriver,google-chrome的配置，但是仍然没有效果，最后发现centos 上的browsermob-proxy 是2.0-beta版本，而其他两个是2.14版本，最后调整之后，发现运行没有问题(暂时弄不明白为什么)<br>
记录下正确的版本配置：<br>
selenium: 3.141.0<br>
chromdriver:75.0.3770.90<br>
google-chrome: 75.0.3770.142<br>
browsermob-proxy:2.1.4</p>
<blockquote>
<p>日志增长的问题</p>
</blockquote>
<p>考虑到网关日志增长过大的可能性，考虑到使用脚本定期定量切割日志,重命名，创建新文件，后来发现linux系统中有现成工具 logrotate 可以对日志进行切割，里面的配置完全可以满足个人需求<br>
可以使用 man  logrotate 查看配置信息 或者  <a href="https://linux.die.net/man/8/logrotate" target="_blank" rel="noopener">logrotate Linxu 官网档案</a></p>
<blockquote>
<p>个人配置</p>
</blockquote>
<pre><code>位置：/etc/logrotate.d/kong
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/kong/logs/access.log &#123;</span><br><span class="line">    missingok</span><br><span class="line">    rotate 200</span><br><span class="line">    size 10M</span><br><span class="line">    compress</span><br><span class="line">    delaycompress</span><br><span class="line">    notifempty</span><br><span class="line">    create 644 root root</span><br><span class="line">    dateext</span><br><span class="line">    sharedscripts</span><br><span class="line">    postrotate</span><br><span class="line">            if [ -f /var/run/nginx.pid ]; then</span><br><span class="line">                    kill -USR1 `cat /usr/local/kong/pids/nginx.pid`</span><br><span class="line"></span><br><span class="line">            fi</span><br><span class="line">    endscript</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre>
<p>原本为 cat /var/run/nginx.pid 后来发现,kong的pid信息存放在/usr/local/kong/pids/nginx.pid<br>
kill -USR1 在这里指重新加载配置信息，重新建立对日志文件的连接<br>
详情 man kill/kill -l 或者查看 <a href="http://www.man7.org/linux/man-pages/man2/kill.2.html" target="_blank" rel="noopener">Linux kill 文档</a>  [Linux  signal 文档](<a href="http://www.man7.org/linux/man-pages/man7/signal.7.html" target="_blank" rel="noopener">http://www.man7.org/linux/man-pages/man7/signal.7.html</a></p>
<p>包装 elastisearch API接口，简化经网关转发提供给外部使用<a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.0/index.html" target="_blank" rel="noopener">Elastisearch 官网开放API 文档</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">获取某一时间 ddj 服务的访问次数</span><br><span class="line">GET /_count</span><br><span class="line">&#123;</span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line">      &quot;bool&quot;:&#123;</span><br><span class="line">      &quot;filter&quot;: &#123;</span><br><span class="line">                &quot;range&quot;: &#123;</span><br><span class="line">                  &quot;@timestamp&quot;: &#123;</span><br><span class="line">                    &quot;gte&quot;: &quot;now-100h/h&quot;,</span><br><span class="line">                    &quot;lte&quot;: &quot;now/h&quot;,</span><br><span class="line">                    &quot;format&quot;: &quot;epoch_millis&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ,</span><br><span class="line">        &quot;must&quot;: &#123;</span><br><span class="line">                &quot;match&quot;: &#123;</span><br><span class="line">                  &quot;request&quot;: &#123;</span><br><span class="line">                    &quot;query&quot;: &quot;*ddj*&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">获取某一时间 ddj 服务的访问信息，相比于上者更为详细</span><br><span class="line">GET /_search</span><br><span class="line">&#123;</span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line">      &quot;bool&quot;:&#123;</span><br><span class="line">      &quot;filter&quot;: &#123;</span><br><span class="line">                &quot;range&quot;: &#123;</span><br><span class="line">                  &quot;@timestamp&quot;: &#123;</span><br><span class="line">                    &quot;gte&quot;: &quot;now-100h/h&quot;,</span><br><span class="line">                    &quot;lte&quot;: &quot;now/h&quot;,</span><br><span class="line">                    &quot;format&quot;: &quot;epoch_millis&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ,</span><br><span class="line">        &quot;must&quot;: &#123;</span><br><span class="line">                &quot;match&quot;: &#123;</span><br><span class="line">                  &quot;request&quot;: &#123;</span><br><span class="line">                    &quot;query&quot;: &quot;*ddj*&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,&quot;aggs&quot;: &#123;</span><br><span class="line">            &quot;dateAgg&quot;: &#123;</span><br><span class="line">              &quot;date_histogram&quot;: &#123;</span><br><span class="line">                &quot;field&quot;: &quot;@timestamp&quot;,</span><br><span class="line">                &quot;time_zone&quot;: &quot;Europe/Amsterdam&quot;,</span><br><span class="line">                &quot;interval&quot;: &quot;1m&quot;,</span><br><span class="line">                &quot;min_doc_count&quot;: 1</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本来想自己开发一个插件，似乎<a href="https://docs.konghq.com/hub/" target="_blank" rel="noopener">Kong Hub</a>上提供的第三方插件 <a href="https://docs.konghq.com/hub/stone-payments/kong-plugin-template-transformer/" target="_blank" rel="noopener">Template Transformer</a> 可以满足需要，<a href="https://github.com/stone-payments/kong-plugin-template-transformer" target="_blank" rel="noopener">源码</a>可以观摩下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST http://localhost:8001/routes/4f240596-9f55-4b90-a2be-2329be72391e/plugins --data &quot;name=kong-plugin-template-transformer&quot;   --data &quot;config.request_template=&apos; &#123;</span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line">      &quot;bool&quot;: &#123;</span><br><span class="line">      &quot;filter&quot;: &#123;</span><br><span class="line">                &quot;range&quot;: &#123;</span><br><span class="line">                  &quot;@timestamp&quot;: &#123;</span><br><span class="line">                    &quot;gte&quot;: &quot;now-&#123;&#123;headers.gt&#125;&#125;h/h&quot;,</span><br><span class="line">                    &quot;lte&quot;: &quot;now/h&quot;,</span><br><span class="line">                    &quot;format&quot;: &quot;epoch_millis&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ,</span><br><span class="line">        &quot;must&quot;: &#123;</span><br><span class="line">                &quot;match&quot;: &#123;</span><br><span class="line">                  &quot;request&quot;: &#123;</span><br><span class="line">                    &quot;query&quot;: &quot;*&#123;&#123;headers.department&#125;&#125;*&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;&quot;</span><br><span class="line">&#123;&quot;query&quot;:&#123;&quot;bool&quot;:&#123;&quot;filter&quot;: &#123;&quot;range&quot;: &#123;&quot;@timestamp&quot;:&#123;&quot;gte&quot;: &quot;now-&#123;&#123;headers.gt&#125;&#125;h/h&quot;,&quot;lte&quot;: &quot;now/h&quot;,&quot;format&quot;: &quot;epoch_millis&quot;&#125;&#125;&#125;&#125;&#125;,&quot;size&quot;:0,&quot;aggs&quot;:&#123;&quot;test&quot;:&#123;&quot;terms&quot;:&#123; &quot;field&quot;: &quot;user.keyword&quot;,&quot;size&quot;:&#123;&#123;headers.size&#125;&#125;&#125;&#125;&#125;&#125;&quot;</span><br><span class="line">/api/v1/data/es/list_user</span><br><span class="line">curl -X POST http://localhost:8001/routes/&#123;route&#125;/plugins --data &quot;name=kong-plugin-template-transformer&quot;   --data</span><br><span class="line">&quot;config.request_template=&#123;</span><br><span class="line">      \&quot;query\&quot;: &#123;</span><br><span class="line">        \&quot;bool\&quot;: &#123;</span><br><span class="line">          \&quot;filter\&quot;: &#123;</span><br><span class="line">            \&quot;range\&quot;: &#123;</span><br><span class="line">              \&quot;@timestamp\&quot;: &#123;</span><br><span class="line">                \&quot;gte\&quot;: \&quot;now-&#123;&#123;headers.gt&#125;&#125;h/h\&quot;,</span><br><span class="line">                \&quot;lte\&quot;: \&quot;now/h\&quot;,</span><br><span class="line">                \&quot;format\&quot;: \&quot;epoch_millis\&quot;</span><br><span class="line">                &#125;</span><br><span class="line">               &#125;</span><br><span class="line">              &#125;</span><br><span class="line">             &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">      \&quot;size\&quot;:0,  </span><br><span class="line">      \&quot;aggs\&quot;: &#123;</span><br><span class="line">        \&quot;test\&quot;:&#123;</span><br><span class="line">          \&quot;terms\&quot;:&#123; </span><br><span class="line">          \&quot;field\&quot;: \&quot;user.keyword\&quot;,</span><br><span class="line">          \&quot;size\&quot;:&#123;&#123;headers.size&#125;&#125;</span><br><span class="line">          &#125; </span><br><span class="line">         &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">      &#125;&quot;</span><br><span class="line"></span><br><span class="line">/api\/v1\/data\/es\/history</span><br><span class="line">curl -X POST http://localhost:8001/routes/&#123;route&#125;/plugins --data &quot;name=kong-plugin-template-transformer&quot;   --data</span><br><span class="line">&quot;config.request_template=&#123;</span><br><span class="line">  \&quot;size\&quot;: &#123;&#123;headers.size&#125;&#125;,</span><br><span class="line">  \&quot;query\&quot;: &#123;</span><br><span class="line">    \&quot;bool\&quot;: &#123;</span><br><span class="line">      \&quot;must\&quot;: [</span><br><span class="line">        &#123; \&quot;match\&quot;: &#123;  \&quot;user\&quot;: \&quot;&#123;&#123;headers.name&#125;&#125;\&quot;  &#125; &#125;, </span><br><span class="line">        &#123; \&quot;match\&quot;: &#123; \&quot;_index\&quot;:\&quot;system-syslog*\&quot; &#125; &#125;]    </span><br><span class="line">        &#125;  </span><br><span class="line">      &#125;,</span><br><span class="line">  \&quot;_source\&quot;: &#123;</span><br><span class="line">    \&quot;includes\&quot;: [\&quot;@timestamp\&quot;,\&quot;referer\&quot;,\&quot;request\&quot;,\&quot;user\&quot;]</span><br><span class="line">    &#125;,  </span><br><span class="line">  \&quot;sort\&quot;: [</span><br><span class="line">    &#123;\&quot;@timestamp\&quot;:&#123;\&quot;order\&quot;:\&quot;desc\&quot; ,\&quot;unmapped_type\&quot;:\&quot;date\&quot; &#125; &#125;,    </span><br><span class="line">    &#123;\&quot;_score\&quot;:&#123;\&quot;order\&quot;:\&quot;asc\&quot; &#125; &#125;  </span><br><span class="line">    ]</span><br><span class="line">    &#125;&quot;</span><br></pre></td></tr></table></figure>
<p>2019-9-24  更改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X POST   --url http://localhost:8001/services/-search/routes  --data &apos;paths=/api/v1/data/es/history&apos;</span><br><span class="line">curl -X POST http://localhost:8001/routes/&#123;route_id&#125;/plugins --data &quot;name=kong-plugin-template-transformer&quot;   --data &quot;config.request_template=&#123;</span><br><span class="line">    \&quot;query\&quot;: &#123;</span><br><span class="line">      \&quot;bool\&quot;: &#123;</span><br><span class="line">      \&quot;filter\&quot;: &#123;</span><br><span class="line">                \&quot;range\&quot;: &#123;</span><br><span class="line">                  \&quot;@timestamp\&quot;: &#123;</span><br><span class="line">                    \&quot;gte\&quot;: \&quot;now-&#123;&#123;headers.gt&#125;&#125;h/h\&quot;,</span><br><span class="line">                    \&quot;lte\&quot;: \&quot;now/h\&quot;,</span><br><span class="line">                    \&quot;format\&quot;: \&quot;epoch_millis\&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ,</span><br><span class="line">        \&quot;must\&quot;: &#123;</span><br><span class="line">                \&quot;match\&quot;: &#123;</span><br><span class="line">                  \&quot;request\&quot;: &#123;</span><br><span class="line">                    \&quot;query\&quot;: \&quot;*&#123;&#123;headers.department&#125;&#125;*\&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;&quot;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X POST   --url http://localhost:8001/services/-search/routes  --data &apos;paths=/api/v1/data/es/history&apos;</span><br><span class="line">&#123;</span><br><span class="line">  \&quot;size\&quot;: &#123;&#123;headers.size&#125;&#125;,</span><br><span class="line">  \&quot;query\&quot;: &#123;</span><br><span class="line">   \&quot;bool\&quot;: &#123;</span><br><span class="line">      \&quot;must\&quot;: [</span><br><span class="line">        &#123; \&quot;match\&quot;: &#123;  \&quot;user\&quot;: \&quot;&#123;&#123;headers.name&#125;&#125;\&quot;  &#125; &#125;,</span><br><span class="line">        &#123; \&quot;match\&quot;: &#123; \&quot;_index\&quot;:\&quot;system-syslog*\&quot; &#125; &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  \&quot;_source\&quot;: &#123;</span><br><span class="line">    \&quot;includes\&quot;: [</span><br><span class="line">     \&quot;@timestamp\&quot;,</span><br><span class="line">      \&quot;referer\&quot;,</span><br><span class="line">      \&quot;request\&quot;,</span><br><span class="line">      \&quot;user\&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  \&quot;sort\&quot;: [</span><br><span class="line">    &#123;\&quot;@timestamp\&quot;:&#123;\&quot;order\&quot;:\&quot;desc\&quot; ,\&quot;unmapped_type\&quot;:\&quot;date\&quot; &#125; &#125;,</span><br><span class="line">    &#123;\&quot;_score\&quot;:&#123;\&quot;order\&quot;:\&quot;asc\&quot; &#125; &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">curl -i -X POST   --url http://localhost:8001/services/-search/routes  --data &apos;paths=/api/v1/data/es/list_user&apos;</span><br><span class="line">curl -X POST http://localhost:8001/routes/ad0226f7-0877-4557-b81b-f30cd227cf61/plugins --data &quot;name=kong-plugin-template-transformer&quot;   --data &quot;config.request_template=&#123;</span><br><span class="line">    \&quot;query\&quot;: &#123;</span><br><span class="line">      \&quot;bool\&quot;: &#123;</span><br><span class="line">      \&quot;filter\&quot;: &#123;</span><br><span class="line">                \&quot;range\&quot;: &#123;</span><br><span class="line">                  \&quot;@timestamp\&quot;: &#123;</span><br><span class="line">                    \&quot;gte\&quot;: \&quot;now-&#123;&#123;headers.gt&#125;&#125;h/h\&quot;,</span><br><span class="line">                    \&quot;lte\&quot;: \&quot;now/h\&quot;,</span><br><span class="line">                    \&quot;format\&quot;: \&quot;epoch_millis\&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">  \&quot;size\&quot;:0,</span><br><span class="line">  \&quot;aggs\&quot;: &#123;</span><br><span class="line">    \&quot;test\&quot;: &#123;</span><br><span class="line">      \&quot;terms\&quot;: &#123;</span><br><span class="line">        \&quot;field\&quot;: \&quot;user.keyword\&quot;,</span><br><span class="line">        \&quot;size\&quot;:&#123;&#123;headers.size&#125;&#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;&quot;</span><br></pre></td></tr></table></figure>
<p>luarocks make<br>
luarocks pack kong-plugin-myplugin 0.1.0-1<br>
luarocks install kong-plugin-myplugin-0.1.0-1.all.rock<br>
kong restart</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/15/工作求职/Spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/15/工作求职/Spring/" class="post-title-link" itemprop="url">Spring</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-15 17:03:39" itemprop="dateCreated datePublished" datetime="2019-05-15T17:03:39+08:00">2019-05-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-01-15 10:57:17" itemprop="dateModified" datetime="2021-01-15T10:57:17+08:00">2021-01-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Spring Security 核心功能</p>
<ul>
<li>认证</li>
<li>授权</li>
<li>攻击防护</li>
</ul>
<p>其实质是一组过滤器链,项目启动后会自动配置</p>
<ul>
<li>UserNamePassWord Authentication Filter</li>
<li>Basic Authentation Filter</li>
<li>Exception Transaction Filter</li>
<li>FilterSecurity Interceptor</li>
</ul>
<p>创建配置类</p>
<blockquote>
<p>SecurityConfig继承自WebSecurityConfigurerAdapter,重写config 方法 在里面可以配置 登录重定向的地址以及提交登录表单的地址 以及可以直接访问的url<br>
获取认证信息<br>
继承UserDetailSevice接口,实现loadUserByUsername方法,实现用户名和密码的匹配,验证通过之后返回经过验证的用户信息(包含权限等信息)</p>
</blockquote>
<p>spring security 和 oauth 认证中涉及的环节<br>
‘’’<br>
UsernamePasswordAuthenticationToken继承AbstractAuthenticationToken实现Authentication<br>
所以当在页面中输入用户名和密码之后首先会进入到UsernamePasswordAuthenticationToken验证(Authentication)，<br>
然后生成的Authentication会被交由AuthenticationManager来进行管理<br>
而AuthenticationManager管理一系列的AuthenticationProvider，<br>
而每一个Provider都会通UserDetailsService和UserDetail来返回一个<br>
以UsernamePasswordAuthenticationToken实现的带用户名和密码以及权限的Authentication<br>
<a href="https://www.cnblogs.com/softidea/p/6716807.html" target="_blank" rel="noopener">参考博客</a><br>
‘’’</p>
<p>Spring Aop</p>
<blockquote>
<p><a href="https://www.jianshu.com/p/5b9a0d77f95f" target="_blank" rel="noopener">参考1</a><br>
面向切面编程，在程序开发中主要用来解决一些系统层面上的问题即公用模块，比如日志，事务，权限等待，Struts2的拦截器设计就是基于AOP的思想;在不改变原有的逻辑的基础上，增加一些额外的功能。代理也是这个功能，读写分离也能用aop来做<br>
应用(注解)：Authentication logging, tracing,Transactions</p>
</blockquote>
<p>Spring IOC/DI<br>
<a href="https://juejin.im/post/6867526780916334605" target="_blank" rel="noopener">Spring IOC核心理论</a></p>
<blockquote>
<p>Inversion of Control 控制反转 依赖注入<br>
IOC ，就是由 Spring IOC 容器来负责对象的生命周期和对象之间的关系<br>
Mybatic<a href="https://www.w3cschool.cn/mybatis/" target="_blank" rel="noopener">参考</a><br>
支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。<br>
dao mapper<br>
Mybatis的功能架构分为三层：</p>
</blockquote>
<ul>
<li>API接口层：提供给外部使用的接口API，开发人员通过这些本地API来操纵数据库。接口层一接收到调用请求就会调用数据处理层来完成具体的数据处理。</li>
<li>数据处理层：负责具体的SQL查找、SQL解析、SQL执行和执行结果映射处理等。它主要的目的是根据调用的请求完成一次数据库操作。</li>
<li>基础支撑层：负责最基础的功能支撑，包括连接管理、事务管理、配置加载和缓存处理，这些都是共用的东西，将他们抽取出来作为最基础的组件。为上层的数据处理层提供最基础的支撑。</li>
</ul>
<p>Filter过滤器 VS Interceptor拦截器 VS AOP</p>
<ul>
<li>过滤器拦截web访问url地址。 严格意义上讲，filter只是适用于web中，依赖于Servlet容器，利用Java的回调机制进行实现</li>
<li>拦截器拦截以 .action结尾的url，拦截Action的访问。 Interfactor是基于Java的反射机制（APO思想）进行实现，不依赖Servlet容器</li>
</ul>
<p><a href="https://blog.csdn.net/qq_30257149/article/details/88224879" target="_blank" rel="noopener">Spring源码之ApplicationContext</a></p>
<p><a href="https://segmentfault.com/a/1190000019560001" target="_blank" rel="noopener">深入理解SpringApplication</a></p>
<p><a href="https://juejin.im/post/6844903844917280781" target="_blank" rel="noopener">Spring源码之注解扫描Component-scan</a></p>
<h2 id="spring-security">Spring Security</h2>
<p>BeanDefinitionReader 读取配置，创建BeanDefinition 注册到BeanDefinitionRegister</p>
<p>Spring Boot 启动流程<br>
<a href="https://segmentfault.com/a/1190000019560001" target="_blank" rel="noopener">深入理解SpringApplication</a></p>
<ul>
<li>入口函数</li>
</ul>
<blockquote>
<p>启动类 main 函数 SpringApplication.run(*.class,args)</p>
</blockquote>
<blockquote>
<p>两个参数：第一个参数为Spring容器配置类,第二个参数 命令行参数,将参数转给SpringApplication 类,通过命令行参数对java应用做一些配置<br>
SpringApplication 会完成以下事项来启动应用：</p>
<ul>
<li>为应用创建合适的ApplicationContext</li>
<li>注册一个CommandLinePropertySource,通过CommandPropertySource可以对外暴露命令行参数,并将命令行参数与应用的properties 联系起来</li>
<li>启动ApplicationContext</li>
<li>执行所有CommandLineRunner类型的Bean</li>
</ul>
</blockquote>
<blockquote>
<p>@SpringBootApplication 注解 包含 @SpringBootConfiguration @EnableAutoConfiguration @ComponentScan<br>
@ComponentScan 默认会扫描 被 @Service @Component @Repository @Controller 注解的类,并注册进容器</p>
</blockquote>
<ul>
<li>初始化 SpringApplication</li>
</ul>
<blockquote>
<p>new SpringApplication(primarySources).run(args)<br>
Spring的初始化流程</p>
<ul>
<li>初始化Spring容器的配置类 primarySources</li>
<li>推断应用程序的类型,进而根据类型 创建不同的ApplicationContext
<ul>
<li>根据classpath下面存在org.springframework.web.reactive.DispatcherHandler 类,则应用类型是REACTIVE,需启动内嵌 web Server;对应AnnotationConfigReactiveWebServerApplicationContext</li>
<li>如果存在 org.springframework.web.servlet.DispatcherServlet 类,则应用类型 是SERVLET,需要启动内嵌的web server;对应AnnotationConfigServletWebServerApplicationContext</li>
<li>都不存在,则是NONE类型,无需 内嵌 web server;对应AnnotationConfigApplicationContext</li>
</ul>
</li>
<li>初始化指定的ApplicationContextInitializatier列表
<ul>
<li>借助SpringFactoryiesLoader 读取jar包中 META-INF/spring.factories 配置文件完成初始化</li>
</ul>
</li>
<li>初始化指定的ApplicationListener 类
<ul>
<li>借助SpringFactoryiesLoader 读取jar包中 META-INF/spring.factories 配置文件完成初始化</li>
</ul>
</li>
<li>推断main class 的类名称
<ul>
<li>通过遍历异常堆栈,获取方法名为main的元素,确认该元素对应的类为主类</li>
</ul>
</li>
</ul>
</blockquote>
<ul>
<li>运行</li>
</ul>
<blockquote>
<ul>
<li>新建StopWatch 对象,记录应用启动的时间</li>
<li>利用SpringFactoriesLoader的机制加载所有的SpringRunListener(啥用？),并封装为SpringRunListeners</li>
<li>listeners.start()</li>
<li>根据ApplicationType,创建并配置SpringApplication要是用的Environment(包括propertySource和Profile)</li>
<li>listener.environmentPrepared()</li>
<li>根据ApplicationType 创建 ApplicationContext.</li>
<li>调用ApplicationContextIniatializer完成ApplicationContext的初始化</li>
<li>listeners.contextPrepared()</li>
<li>向ApplicationContext加载所有Bean</li>
<li>listeners.contextLoaded()</li>
<li>调用ApplicationContext的refresh方法(干啥),完成最后一道手续</li>
<li>listeners.startedContext()</li>
<li>检查当前Spring容器是否有ApplicationRunner 和 CommandLineRunner 类型的bean,如果有便利执行</li>
<li>listeners.running(context)<br>
完成启动</li>
</ul>
</blockquote>
<ul>
<li>扫描</li>
</ul>
<blockquote>
<p>会扫描 启动类所在包以及子路径下的所有编译产生的class文件,然后 判断是否满足要求,对于满足要求的注解进容器<br>
class 包含的数据结构包括 源文件,常量池,接口,字段,方法,属性(包含了接口的种类)</p>
</blockquote>
<p>bean 的生命周期<br>
<img src="/images/spring-bean-live-procedure.jpg" alt="用来描述图片的关键词"></p>
<blockquote>
<ol>
<li>Spring 对bean进行实例化</li>
<li>Spring 将值以及对Bean的引用注入bean 对应的属性中</li>
<li>如果bean 实现了BeanNmaeAware 接口,Spring 将bean的ID传递给setBeanName()方法</li>
<li>如果bean实现了BeanFactoryAware 接口 Spring 将调动setBeanFactory()方法，将beanFactory 容器实例传入</li>
<li>如果 bean实现了ApplicationContextAware 接口，Spring 将调用setApplicationContext方法，将bean所在应用的上下文的引用传入进来;</li>
<li>如果bean实现了BeanPostProcessor 接口，Spring将调用它们的postProcessBeforeInitialization() 方法</li>
<li>如果bean 实现了 InitializatingBean 接口,Spring  将调用它们的afterPropertiesSet 方法,类似的 如果 bean使用了 init-method 声明了初始化方法,该方法也会被调用</li>
<li>如果bean 实现了 BeanPostProcessor 接口,Spring 将调用了它们的postProcessAfterInitialization() 方法</li>
<li>此时 Bean 已经准备就绪,可以被应用程序使用, 他们将一直驻留在应用上下文中,直至该上下文被销毁</li>
<li>如果bean实现了 DisposableBean 接口,Spring将调用它的destroy() 接口。同样,如果bean 使用了destroy—method 声明了销毁方法,该方法也会被调用。</li>
</ol>
</blockquote>
<p>Bean的注册和填充</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Spring组件按其所承担的角色可以划分为两类：</span><br><span class="line">1）物料组件：Resource、BeanDefinition、PropertyEditor以及最终的Bean等，它们是加工流程中被加工、被消费的组件，就像流水线上被加工的物料；</span><br><span class="line">2）加工设备组件：ResourceLoader、BeanDefinitionReader、BeanFactoryPostProcessor、InstantiationStrategy以及BeanWrapper等组件像是流水线上不同环节的加工设备，对物料组件进行加工处理</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Spring提供了BeanFactory对Bean进行获取，但Bean的注册和管理并不是在BeanFactory中进行的，而是在BeanDefinitionRegistry中进行的<br>
通过定义BeanDefination(AnnotationBeanDefination) 绑定了beanclass 和bean的其他一些信息(scope,autowiredMode,factorybeanName:获得BeanFactory 创建Bean)<br>
BeanDefinitionRegistry中的CocurrentHashMap 存储了 beanName 与 BeanDefination</p>
</blockquote>
<blockquote>
<p>SingletonObject (CocurrentMap) 存储 beanName 和 BeanInstance的映射</p>
</blockquote>
<p>bean 实例化</p>
<blockquote>
<p>实例化阶段主要是通过反射或者CGLIB对bean进行实例化，在这个阶段Spring又给我们暴露了很多的扩展点：</p>
<ul>
<li>各种的Aware接口，比如 BeanFactoryAware，MessageSourceAware，ApplicationContextAware</li>
<li>BeanPostProcessor接口,实例化bean时Spring会帮我们调用接口中的方法：</li>
<li>InitializingBean:@PostConstruct 和 @PreDestroy</li>
<li>DisposablegBean</li>
</ul>
</blockquote>
<p>单例bean的效率和安全性</p>
<blockquote>
<p>默认单例bean<br>
通过ThreadLocal实现对于bean中局部变量的多线程共享访问,互不干扰, 安全且高效<br>
对于bean中的全局或者静态变量,可以声明scope为原型模式</p>
</blockquote>
<p>原型模式    VS      工厂模式</p>
<blockquote>
<p>抽象工厂模式：通常由工厂方法模式来实现。但一个工厂中往往含有多个工厂方 法生成一系列的产品。这个模式强调的是客户代码一次保证只使用一个系列的产品。当要切换为另一个系列的产品，换一个工厂类即可。<br>
原型模式：工厂方法的最大缺点就是，对应一个继承体系的产品类，要有一个同 样复杂的工厂类的继承体系。我们可以把工厂类中的工厂方法放到产品类自身之 中吗？如果这样的话，就可以将两个继承体系为一个。这也就是原型模式的思想，原型模式中的工厂方法为clone，它会返回一个拷贝（可以是浅拷贝，也可以是深拷贝，由设计者决定）。为了保证用户代码中到时可以通过指针调用 clone 来动 态绑定地生成所需的具体的类。这些原型对象必须事先构造好。<br>
原型模式想对工厂方法模式的另一个好处是，拷贝的效率一般对构造的效率要高</p>
</blockquote>
<p>Spring 事物传播<br>
<a href="https://blog.csdn.net/qq_26323323/article/details/81908955" target="_blank" rel="noopener">参考1</a></p>
<blockquote>
<p>事物保证操作的原子性,不保证正确率<br>
事务在多个方法的调用中是如何传递的，是重新创建事务还是使用父方法的事务？父方法的回滚对子方法的事务是否有影响？这些都是可以通过事务传播机制来决定的。</p>
<ul>
<li>Propagation.REQUIRED：如果有事务则加入事务，如果没有事务，则创建一个新的(默认值)</li>
<li>NOT_SUPPORTED: 以非事务方式执行操作，如果当前存在事务，就把当前事务挂起。</li>
<li>REQUIRES_NEW:不管是否存在事务，都创建一个新的事务，原来的方法挂起，新的方法执行完毕后，继续执行老的事务</li>
<li>MANDATORY:必须在一个已有的事务中执行，否则报错</li>
<li>NEVER:必须在一个没有的事务中执行，否则报错(可能会导致已存在的事物回滚)</li>
<li>SUPPORTS:是否使用事务取决于调用方法者是否有事务，如果有则直接用，如果没有则不使用事务</li>
<li>NESTED:如果当前存在事务，则在<a href="http://blog.chinaunix.net/uid-10289334-id-2964925.html" target="_blank" rel="noopener">嵌套事务</a>内执行。如果当前没有事务，则执行与REQUIRED类似的操作;嵌套事物相当于在一个事物中嵌入一个子事物,子事物依赖于父事物,嵌入点为savePoint,子事物失败可以会滚回savePoint,</li>
</ul>
</blockquote>
<p>Spring 自动装配策略</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public interface AutowireCapableBeanFactory&#123;</span><br><span class="line">    //无需自动装配：默认配置,对所有Bean不自动装配,除非Bean配置了autowire 属性 </span><br><span class="line">    int AUTOWIRE_NO = 0;</span><br><span class="line"></span><br><span class="line">    //按名称自动装配bean属性:把与Bean的属性具备相同名字的其他Bean 填充到该Bean的对应属性中</span><br><span class="line">    int AUTOWIRE_BY_NAME = 1;</span><br><span class="line"></span><br><span class="line">    //按类型自动装配bean属性:把与Bean的属性具备相同类型的Bean自动装配到Bean的对应属性中</span><br><span class="line">    int AUTOWIRE_BY_TYPE = 2;</span><br><span class="line"></span><br><span class="line">    //按构造器自动装配：根据Bean的构造器入参类型,寻找具有相同类型的其他Bean 对应参数 入参</span><br><span class="line">    int AUTOWIRE_CONSTRUCTOR = 3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@Autowired 流程</p>
<blockquote>
<p>@Inject @Value<br>
注入时间:在Spring容器启动后,加载类,Bean 实例化之后通过实现AutowiredAnnotationPostProcessor实现注入<br>
@Autowired, @Inject, @Resource, and @Value annotations are handled by Spring BeanPostProcessor implementations which in turn means that you cannot apply these annotations within your own BeanPostProcessor or BeanFactoryPostProcessor types (if any). These types must be ‘wired up’ explicitly via XML or using a Spring @Bean method.</p>
</blockquote>
<p>参考：</p>
<ul>
<li><a href="https://segmentfault.com/a/1190000018077152" target="_blank" rel="noopener">Spring源码分析：@Autowired注解原理分析</a></li>
<li><a href="https://www.cnblogs.com/zhmlearn/p/12247073.html" target="_blank" rel="noopener">记录一次追踪@AutoWired的过程</a></li>
<li><a href="https://docs.spring.io/spring/docs/4.3.22.RELEASE/spring-framework-reference/htmlsingle/#beans-autowired-annotation" target="_blank" rel="noopener">官网doc</a><br>
注解的流程</li>
</ul>
<p>三段式事务提交</p>
<p>数据库锁</p>
<blockquote></blockquote>
<p><a href="https://zhshuixian.github.io/learn-spring-boot-2/#/06-SpringSecurity" target="_blank" rel="noopener">Spring Security</a></p>
<blockquote>
<p>对于 Web 系统来说，对页面和 API 接口的访问权限进行安全控制是必须的，例如需要阻止非系统用户的访问，控制不同页面或接口的访问权限。在 Java 开发中，常用的安全框架有 Spring Security 和 Apache Shiro<br>
Spring Security 主要包括如下两个部分：</p>
</blockquote>
<ul>
<li>登录认证（Authentication）</li>
<li>访问授权（Authorization）</li>
</ul>
<p>使用 Spring Security ，只需要实现 UserDetailsService 接口和继承 WebSecurityConfigurerAdapter</p>
<ul>
<li>loadUserByUsername：通过重写 UserDetailsService 接口的 loadUserByUsername 方法，给 Spring Security 传入用户名、用户密码、用户角色。</li>
<li>BCryptPasswordEncoder ：通过 BCrypt 强哈希方法加密存储密码。对于 Web 系统来说，几乎不会明文存储密码。Spring Security 提供的 BCryptPasswordEncoder 类实现密码加密的功能。BCrypt 强哈希方法每次加密的结果是不同的。</li>
</ul>
<p>@PreAuthorize 表示这个 URL 需要某种角色权限才能访问</p>
<p>Spring Security (Token)登录和注册</p>
<p>在分布式系统中，不同机器上服务可能同时访问共享数据资源，如果出现多个服务同时写入、读取就会发生不同客户端获取的数据不一致的情况，最终的数据也会出错；对于这些情况，需要引入 分布式锁 ，保证同一时刻只有一个服务访问操作共享数据，使用跨 JVM 的互斥机制控制共享资源的访问。分布式锁有多种实现方式，例如基于数据库、Zookeeper、Redis、Memcached、Chubby。</p>
<p>分布式锁应当具备如下条件：</p>
<ul>
<li>互斥性：保证同一资源在同一时间只能被一个线程访问</li>
<li>高可用、高性能：获取锁与释放锁的高可用与高性能</li>
<li>锁失效机制：防止拿到锁的线程挂了没有释放锁导致死锁</li>
<li>非阻塞锁：没有获得锁直接返回失败，而不是等待直到获得锁</li>
<li>可重入性：锁过期或释放后，其线程可以继续获得锁，而不会发生数据错误</li>
</ul>
<p>RocketMQ</p>
<p>Spring bean 分类</p>
<p>什么是Spring MVC ？简单介绍下你对springMVC的理解?</p>
<p>SpringMVC的流程？<br>
Springmvc的优点:</p>
<p>Spring MVC的主要组件？<br>
<a href="https://blog.csdn.net/a745233700/article/details/80963758" target="_blank" rel="noopener">SpringMVC常见面试题总结</a></p>
<p><a href="https://blog.csdn.net/a745233700/article/details/80959716" target="_blank" rel="noopener">Spring常见面试题总结</a></p>
<p>注解<br>
@Repository：用于标注数据访问组件,即dao组价<br>
@Primary、@Qualifier</p>
<h3 id="aop">AOP</h3>
<p>面向切面编程</p>
<h4 id="基本概念">基本概念</h4>
<p>Aspect</p>
<blockquote>
<p>通知与切入点的集合</p>
</blockquote>
<p>pointCut</p>
<blockquote>
<p>定义在什么类的什么方法执行,确定具体插入的Advice的地方</p>
</blockquote>
<p>joinPoint</p>
<blockquote>
<p>插入Advice的地方,spring aop中方法的前后都可以成为连接点,但具体哪里成为需要切点确定<br>
一般不涉及明确的代码</p>
</blockquote>
<p>advice</p>
<blockquote>
<p>增强,所需要的完成的工作,在pointCut已确定的基础上,决定在切点出现的位置</p>
</blockquote>
<ul>
<li>Before:前置通知,方法调用前执行</li>
<li>After：后置通知 方法调用后执行</li>
<li>After-returning ：在方法调用后有结果时执行,有结果的话优先级高于after</li>
<li>After-throwing：方法执行抛出异常时执行</li>
<li>Aroud：相当于before+after的加强版,在其中调用joinpoint.procced()完成具体连接点方法的执行,也可以不执行,在执行前后可以添加逻辑,代替了连接点</li>
</ul>
<p>织入</p>
<blockquote>
<p>将切面与切入点结合这是个逻辑过程</p>
<ul>
<li>编译期织入，这要求使用特殊的Java编译器。</li>
<li>类装载期织入，这要求使用特殊的类装载器。</li>
<li>动态代理织入，在运行期为目标类添加增强生成子类的方式。</li>
</ul>
</blockquote>
<p>@Order</p>
<blockquote>
<p>标识启动的优先级,可以用于多个切换同时涉及一个连接点时,定义优先级<br>
数字越小优先级越高,默认最低优先级,数字为Integer.Max_Value</p>
</blockquote>
<p>JDK动态代理为什么不能代理类</p>
<blockquote>
<p>已经继承了Proxy,不能多继承</p>
</blockquote>
<h3 id="jdk-动态代理">JDK 动态代理</h3>
<p>Proxy类<br>
InvocationHandler接口<br>
其他涉及类 ProxyUtil ProxyGenerator AdvisedSupport  DefautAdvisorChainFacotry JdkDynamicAopProxy Cglib2AopProxy<br>
AdviseSUpport ProxyFactory<br>
<a href="https://my.oschina.net/u/3687664/blog/4267525" target="_blank" rel="noopener">参考0：Spring AOP执行流程源码解析</a><br>
<a href="https://my.oschina.net/u/3687664/blog/4267549" target="_blank" rel="noopener">参考0-1：pring中通过JDK代理执行aop目标方法流程解析</a><br>
<a href="https://blog.csdn.net/paincupid/article/details/89714862" target="_blank" rel="noopener">参考1:源码通透-spring-AOP-4-spring-AOP-invoke调用过程</a><br>
<a href="https://my.oschina.net/u/4317546/blog/3527274" target="_blank" rel="noopener">参考2：pring AOP 多个切点实现:JdkDynamicAopProxy</a></p>
<p>AOP流程<br>
<a href="https://www.jianshu.com/p/2250b24a3f7d" target="_blank" rel="noopener">BeanPostProcessor里，有一个AnnotationAwareAspectJAutoProxyCreator，spring会在该类的 postProcessBeforeInitialization 里进行Advisor的初始化</a><br>
就是遍历所有的 没有Pointcut注解的方法，调用getAdvisor生成对应的Advisor(包含ascect order信息 ),并缓存<br>
然后在执行bean对象的方法时,会<a href="https://my.oschina.net/u/4317546/blog/3527274" target="_blank" rel="noopener">根据方法名和类名去寻找</a>相应的advisor,从<a href="https://blog.csdn.net/chao_19/article/details/51843352" target="_blank" rel="noopener">AdvisedSupport</a>中寻找;<br>
在 getInterceptorsAndDynamicInterceptionAdvice 里 他会遍历所有的advisor如果和method以及class符合那么将其中的inteceptor都添加进list并返回,将list作为参数构建<a href="https://my.oschina.net/u/2518341/blog/3073722" target="_blank" rel="noopener">ReflectiveMethodInvocation</a> 然后调用其proceed方法执行</p>
<p>对于实现接口A的类B动态代理</p>
<blockquote>
<p>以类B 和 加载器作为参数,Proxy.getProxyClass 生成class对象(文件存储在/com/sun/proxy);</p>
<ul>
<li>首先在缓存中寻找,没有则生成</li>
<li>会递归实现所有接口中包含的方法以及默认方法比如hashcode tostring equal等<br>
然后获取构造器以invocationHandle的实现类invoke0作为参数产生实例Proxy0<br>
proxy0的所有调用 调用invoke0.invoke,调用其实现的方法</li>
</ul>
</blockquote>
<p>AOP实现 基于JDK的实现(JdkDynamicAopProxy继承aopProxy,InvocationHandle;)</p>
<blockquote>
<p>利用JdkDynamicAopProxy 实现代理类class的生成<br>
在newInstance中 invocationHandle的实例指向本身<br>
JdkDynamicAopProxy 内部invoke实现中,</p>
<ul>
<li>会首先判断是常用方法比如toString hashcode Equal 或者没有增强方法就直接返回</li>
<li>如果有,会以方法为key 获取出 切入链条,然后调用(如何获得链条？<a href="https://my.oschina.net/u/3687664/blog/4267525" target="_blank" rel="noopener"></a> 从bean中遍历获取)</li>
</ul>
</blockquote>
<p><a href="https://my.oschina.net/u/3687664/blog/4267480" target="_blank" rel="noopener">Spring Bean的生命周期</a></p>
<h3 id="spring-mvc">Spring MVC</h3>
<h4 id="什么是spring-mvc-简单介绍下你对springmvc的理解">什么是Spring MVC ？简单介绍下你对springMVC的理解</h4>
<p>Spring MVC是一个基于Java的实现了MVC设计模式的请求驱动类型的轻量级Web框架，通过把Model，View，Controller分离，将web层进行职责解耦，把复杂的web应用分成逻辑清晰的几部分，简化开发，减少出错，方便组内开发人员之间的配合</p>
<h4 id="springmvc的流程">SpringMVC的流程？</h4>
<ul>
<li>用户发送请求至前端控制器DispatcherServlet；</li>
<li>DispatcherServlet收到请求后，调用HandlerMapping处理器映射器，请求获取Handle；</li>
<li>处理器映射器根据请求url找到具体的处理器，生成处理器对象及处理器拦截器(如果有则生成)一并返回给DispatcherServlet；</li>
<li>DispatcherServlet 调用 HandlerAdapter处理器适配器；</li>
<li>HandlerAdapter 经过适配调用 具体处理器(Handler，也叫后端控制器)；</li>
<li>Handler执行完成返回ModelAndView；</li>
<li>HandlerAdapter将Handler执行结果ModelAndView返回给DispatcherServlet；</li>
<li>DispatcherServlet将ModelAndView传给ViewResolver视图解析器进行解析；</li>
<li>ViewResolver解析后返回具体View；</li>
<li>DispatcherServlet对View进行渲染视图（即将模型数据填充至视图中）</li>
<li>DispatcherServlet响应用户。</li>
</ul>
<h4 id="spring-mvc-的优点">spring mvc 的优点</h4>
<ul>
<li>清晰的角色分配：前端控制器(dispatcherServlet) , 请求到处理器映射（handlerMapping), 处理器适配器（HandlerAdapter), 视图解析器（ViewResolver）</li>
<li>与Spring框架集成（如IoC容器、AOP等）</li>
</ul>
<h4 id="spring-mvc-的主要组件">Spring MVC 的主要组件</h4>
<ul>
<li>前端控制器 DispatcherServlet(接收请求、响应结果，相当于转发器，有了DispatcherServlet 就减少了其它组件之间的耦合度)</li>
<li>处理器映射器HandlerMapping:根据请求的URL来查找Handler(根据RequestMapping注解获得url和handle的映射)</li>
<li>处理器适配器HandlerAdapter:在编写Handler的时候要按照HandlerAdapter要求的规则去编写，这样适配器HandlerAdapter才可以正确的去执行Handler</li>
</ul>
<blockquote>
<p>SpringMVC的Handler有多种实现方式（Controller，HttpRequestHandler，Servlet等），例如继承Controller接口的形式，基于注解@Controller控制器方式的，HttpRequestHandler方式的。由于实现方式不一样，调用方式就不确定</p>
</blockquote>
<ul>
<li>处理器Handler(Controller Bean)</li>
<li>视图解析器 ViewResolver:进行视图的解析，根据视图逻辑名解析成真正的视图（view）</li>
<li>视图View:View是一个接口， 它的实现类支持不同的视图类型（jsp，freemarker，pdf等等）</li>
</ul>
<h4 id="springmvc怎么样设定重定向和转发的">SpringMVC怎么样设定重定向和转发的？</h4>
<ul>
<li>转发：在返回值前面加&quot;forward:&quot;，譬如&quot;forward:user.do?name=method4&quot;</li>
<li>重定向：在返回值前面加&quot;redirect:&quot;，譬如&quot;redirect:<a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a>&quot;</li>
</ul>
<h4 id="springmvc怎么和ajax相互调用的">SpringMvc怎么和AJAX相互调用的？</h4>
<p>通过Jackson可以将json数据转化为Object,@RequestBody等</p>
<h4 id="springmvc的控制器是不是单例模式如果是有什么问题怎么解决">SpringMvc的控制器是不是单例模式,如果是,有什么问题,怎么解决？</h4>
<p>是单例模式,所以在多线程访问的时候有线程安全问题,不要用同步,会影响性能的,解决方案是在控制器里面不能写字段</p>
<h4 id="springmvc常用的注解有哪些">SpringMVC常用的注解有哪些？</h4>
<p>@RequestMapping：用于处理请求 url 映射的注解，可用于类或方法上。用于类上，则表示类中的所有响应请求的方法都是以该地址作为父路径。<br>
@PathVariable<br>
@RequestBody：注解实现接收http请求的json数据，将json转换为java对象。<br>
@ResponseBody：注解实现将conreoller方法返回对象转化为json对象响应给客户。</p>
<h4 id="注解原理">注解原理：</h4>
<blockquote>
<p>注解本质是一个继承了Annotation的特殊接口，其具体实现类是Java运行时生成的动态代理类。我们通过反射获取注解时，返回的是Java运行时生成的动态代理对象。通过代理对象调用自定义注解的方法，会最终调用AnnotationInvocationHandler的invoke方法。该方法会从memberValues这个Map中索引出对应的值。而memberValues的来源是Java常量池</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/14/基础知识/authen-server/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/14/基础知识/authen-server/" class="post-title-link" itemprop="url">authen_server</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-14 17:11:39" itemprop="dateCreated datePublished" datetime="2019-05-14T17:11:39+08:00">2019-05-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-30 13:21:09" itemprop="dateModified" datetime="2020-08-30T13:21:09+08:00">2020-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>2019-5-14 尝试将spring oauth server安装到 实验室服务器上（虽然是初版），做一下记录<br>
如何用idea 打包 maven项目<br>
‘’’<br>
用idea中maven 打开项目，点击idea 右侧的 Maven Projects，<br>
点击 LIfecycle -&gt; install -&gt; run maven build 即可<br>
‘’’<br>
之后 将该项目scp至服务器<br>
使用 java -jar *.jar 运行<br>
在运行时出现一些错误，如下</p>
<p>‘’’<br>
2019-05-14 17:06:35.986 ERROR 1180706 — [ost-startStop-1] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Exception during pool initialization.</p>
<p>com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure</p>
<p>The last packet successfully received from the server was 199 milliseconds ago.  The last packet sent successfully to the server was 192 milliseconds ago.<br>
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:1.8.0_181]<br>
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) ~[na:1.8.0_181]<br>
…<br>
…<br>
… 154 common frames omitted<br>
Caused by: java.security.cert.CertPathValidatorException: Path does not chain with any of the trust anchors<br>
at sun.security.provider.certpath.PKIXCertPathValidator.validate(PKIXCertPathValidator.java:154) ~[na:1.8.0_181]<br>
at sun.security.provider.certpath.PKIXCertPathValidator.engineValidate(PKIXCertPathValidator.java:80) ~[na:1.8.0_181]<br>
at java.security.cert.CertPathValidator.validate(CertPathValidator.java:292) ~[na:1.8.0_181]<br>
at com.mysql.jdbc.ExportControlled$X509TrustManagerWrapper.checkServerTrusted(ExportControlled.java:295) ~[mysql-connector-java-5.1.46.jar!/:5.1.46]<br>
… 156 common frames omitted</p>
<p>‘’’<br>
经查询(<a href="https://www.jianshu.com/p/b3151ca89def" target="_blank" rel="noopener">https://www.jianshu.com/p/b3151ca89def</a> ）发现是因为SSL配置的原因（暂时没有细究），在源代码 application.yml 文件中将useSSL=true 改为 false即可，重新打包，scp，运行</p>
<p>在查询过程中发现之后可能会出现的另一个问题，即在长时间未连接mysql时会报类似的 Communications link failure 错误，不过这里是因为mysql默认配置 无连接最长等待时间是8小时，可以通过修改配置文件 mysql.ini 去解决这个错误</p>
<p>在此之前需要在服务器安装mysql<br>
按照官网教程(下面的是Ubuntu下的，如果安装在redhat上，会有一些区别 ，具体参照官方教程 <a href="https://dev.mysql.com/doc/mysql-yum-repo-quick-guide/en/" target="_blank" rel="noopener">https://dev.mysql.com/doc/mysql-yum-repo-quick-guide/en/</a>)</p>
<ul>
<li>wget <a href="https://dev.mysql.com/get/mysql-apt-config_0.8.13-1_all.deb" target="_blank" rel="noopener">https://dev.mysql.com/get/mysql-apt-config_0.8.13-1_all.deb</a></li>
<li>也可以选择检查 文件传输中是否出错 md5sum mysql-apt-config_0.8.13-1_all.deb</li>
<li>之后运行 dpkg -i mysql-apt-config_0.8.13-1_all.deb，选择你所需要安装的mysql版本，程序会将之添加到apt源中</li>
<li>运行 sudo apt-get update （–fix-missing）</li>
<li>自动下载之后需要配置用户名与密码，需要与你在spring程序中配置的一致</li>
</ul>
<p>进入数据库 mysql -u root -p ,之后输入密码</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/01/基础知识/Machine_learning_course/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="夸父">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行合一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/01/基础知识/Machine_learning_course/" class="post-title-link" itemprop="url">Machine_learning_course</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-01 10:43:46" itemprop="dateCreated datePublished" datetime="2019-05-01T10:43:46+08:00">2019-05-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-30 13:23:59" itemprop="dateModified" datetime="2020-08-30T13:23:59+08:00">2020-08-30</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>2019-5-10<br>
机器学习布置作业，6-15前交，内容未知<br>
基于主成分分析方法的人脸识别方法</p>
<ul>
<li>之前是寻找空间特征，某一局部点</li>
<li>人脸识别的核心问题是提取特征(人脸的相关性打，冗余信息多？如何去除：主成分分析，如何将一个矩阵变成一个向量)</li>
<li>PCA方法的优缺点：从压缩能量的角度，PCA是最有效率的，可以用于维度压缩</li>
<li>PCA  FisherDiscriminant analysis or LDA</li>
<li>kErnel PCA</li>
<li>KFDA</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="夸父"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">夸父</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">107</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/walkdeadtobe" title="GitHub → https://github.com/walkdeadtobe" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn" rel="noopener" target="_blank">京ICP备2020045262号 </a>
      <img src="/images/gongan.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802033764" rel="noopener" target="_blank">京公网安备 11010802033764 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chengr</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
